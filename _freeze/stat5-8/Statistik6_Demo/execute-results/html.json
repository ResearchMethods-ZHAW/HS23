{
  "hash": "2f514228e064d0d1dafd2fa6b1e724c4",
  "result": {
    "markdown": "---\ndate: 2023-11-14\nlesson: Stat6\nthema: Einführung in \"multivariate\" Methoden\nindex: 1\nformat:\n  html:\n    code-tools:\n      source: true\n---\n\n\n# Stat6: Demo\n\n-   Download dieses Demoscript via \"\\</\\>Code\" (oben rechts)\n\n## Ordinationen I\n\n### PCA\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"labdsv\")\n## Error in library(\"labdsv\"): es gibt kein Paket namens 'labdsv'\n\n# Für Ordinationen benötigen wir Matrizen, nicht Dataframes\n# Generieren von Daten\nraw <- matrix(c(1, 2, 2.5, 2.5, 1, 0.5, 0, 1, 2, 4, 3, 1), nrow = 6)\ncolnames(raw) <- c(\"Art1\", \"Art2\")\nrownames(raw) <- c(\"Ort1\", \"Ort2\", \"Ort3\", \"Ort4\", \"Ort5\", \"Ort6\")\nraw\n##      Art1 Art2\n## Ort1  1.0    0\n## Ort2  2.0    1\n## Ort3  2.5    2\n## Ort4  2.5    4\n## Ort5  1.0    3\n## Ort6  0.5    1\n\n# Originaldaten für Plot separieren\nx1 <- raw[, 1]\ny1 <- raw[, 2]\nz <- c(rep(1:6))\n\n# Plot Abhängigkeit der Arten vom Umweltgradienten\nplot(c(x1, y1) ~ c(z, z),\n  type = \"n\", axes = T, bty = \"l\",\n  las = 1, xlim = c(1, 6), ylim = c(0, 5),\n  xlab = \"Umweltgradient\", ylab = \"Deckung der Arten\"\n)\npoints(x1 ~ z, pch = 21, type = \"b\")\npoints(y1 ~ z, pch = 16, type = \"b\")\ntext(1.5, 1.5, \"Art 1\", col = \"darkgray\")\ntext(1.5, 0.5, \"Art 2\", col = \"darkgray\")\n\n# Daten zentrieren\n# d.h. transformieren so, dass Mittelwert = 0\ncent <- scale(raw, scale = FALSE)\nx2 <- cent[, 1] # für nachfolgenden Plot speichern\ny2 <- cent[, 2] # für nachfolgenden Plot speichern\n\n# Daten zusätzlich rotieren\n# PCA zentriert und rotiert Daten\no.pca <- pca(raw)\n## Error in pca(raw): konnte Funktion \"pca\" nicht finden\nx3 <- o.pca$scores[, 1] # für nachfolgenden Plot speichern\n## Error in eval(expr, envir, enclos): Objekt 'o.pca' nicht gefunden\ny3 <- o.pca$scores[, 2] # für nachfolgenden Plot speichern\n## Error in eval(expr, envir, enclos): Objekt 'o.pca' nicht gefunden\n\n# Visualisierung der Schritte im Ordinationsraum\nplot(c(y1, y2, y3) ~ c(x1, x2, x3),\n  type = \"n\", axes = T, bty = \"l\", las = 1,\n  xlim = c(-4, 4), ylim = c(-4, 4), xlab = \"Art 1\", ylab = \"Art 2\"\n)\n## Error in eval(predvars, data, env): Objekt 'y3' nicht gefunden\npoints(y1 ~ x1, pch = 21, type = \"b\", col = \"green\", lwd = 2)\ntext(-2.5, 4, \"Originaldaten\", col = \"green\")\npoints(y2 ~ x2, pch = 16, type = \"b\", col = \"red\", lwd = 2)\ntext(-2.5, 3.5, \"Zentriert\", col = \"red\")\npoints(y3 ~ x3, pch = 17, type = \"b\", col = \"blue\", lwd = 2)\n## Error in eval(predvars, data, env): Objekt 'y3' nicht gefunden\ntext(-2.5, 3, \"Zentriert & rotiert\", col = \"blue\")\n```\n\n::: {.cell-output-display}\n![](Statistik6_Demo_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\n\n# Durchführung der PCA\no.pca <- pca(raw)\n## Error in pca(raw): konnte Funktion \"pca\" nicht finden\nplot(o.pca)\n## Error in plot(o.pca): Objekt 'o.pca' nicht gefunden\n\n# Koordinaten im Ordinationsraum\no.pca$scores\n## Error in eval(expr, envir, enclos): Objekt 'o.pca' nicht gefunden\n\n# Korrelationen der Variablen mit den Ordinationsachsen\no.pca$loadings\n## Error in eval(expr, envir, enclos): Objekt 'o.pca' nicht gefunden\n\n# Erklärte Varianz der Achsen\nE <- o.pca$sdev^2 / o.pca$totdev * 100\n## Error in eval(expr, envir, enclos): Objekt 'o.pca' nicht gefunden\nE\n## Error in eval(expr, envir, enclos): Objekt 'E' nicht gefunden\n\n# Visualisieren mit prcomp\npca.2 <- prcomp(raw, scale = F)\nsummary(pca.2)\n## Importance of components:\n##                          PC1    PC2\n## Standard deviation     1.548 0.7154\n## Proportion of Variance 0.824 0.1760\n## Cumulative Proportion  0.824 1.0000\nplot(pca.2) #\n```\n\n::: {.cell-output-display}\n![](Statistik6_Demo_files/figure-html/unnamed-chunk-1-2.png){width=672}\n:::\n\n```{.r .cell-code}\nbiplot(pca.2)\n```\n\n::: {.cell-output-display}\n![](Statistik6_Demo_files/figure-html/unnamed-chunk-1-3.png){width=672}\n:::\n\n```{.r .cell-code}\n\n# mit vegan\nlibrary(\"vegan\")\n## Error in library(\"vegan\"): es gibt kein Paket namens 'vegan'\n# Die Funktion rda führt ein PCA aus an wenn nicht Artdaten UND Umweltdaten definiert werden\npca.3 <- rda(raw, scale = FALSE)\n## Error in rda(raw, scale = FALSE): konnte Funktion \"rda\" nicht finden\n# scores(pca.3, display = c(\"sites\"))\n# scores(pca.3, display = c(\"species\"))\nsummary(pca.3, axes = 0)\n## Error in summary(pca.3, axes = 0): Objekt 'pca.3' nicht gefunden\nbiplot(pca.3)\n## Error in biplot(pca.3): Objekt 'pca.3' nicht gefunden\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Mit Beispieldaten aus Wildi\nlibrary(\"dave\")\n\nstr(sveg)\nsummary(sveg)\nnames(sveg)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# PCA: Deckungen Wurzeltransformiert, cor=TRUE erzwingt Nutzung der Korrelationsmatrix\npca.5 <- pca(sveg^0.25, cor = TRUE)\n## Error in pca(sveg^0.25, cor = TRUE): konnte Funktion \"pca\" nicht finden\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Koordinaten im Ordinationsraum\npca.5$scores\n\n# Korrelationen der Variablen mit den Ordinationsachsen\npca.5$loadings\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Erklärte Varianz der Achsen in Prozent (sdev ist die Wurzel daraus)\nE <- pca.5$sdev^2 / pca.5$totdev * 100\n## Error in eval(expr, envir, enclos): Objekt 'pca.5' nicht gefunden\nE\n## Error in eval(expr, envir, enclos): Objekt 'E' nicht gefunden\nE[1:5]\n## Error in eval(expr, envir, enclos): Objekt 'E' nicht gefunden\nplot(pca.5)\n## Error in plot(pca.5): Objekt 'pca.5' nicht gefunden\n# PCA-Plot der Lage der Beobachtungen im Ordinationsraum\nplot(pca.5$scores[, 1], pca.5$scores[, 2], type = \"n\", asp = 1, xlab = \"PC1\", ylab = \"PC2\")\n## Error in plot(pca.5$scores[, 1], pca.5$scores[, 2], type = \"n\", asp = 1, : Objekt 'pca.5' nicht gefunden\npoints(pca.5$scores[, 1], pca.5$scores[, 2], pch = 18)\n## Error in points(pca.5$scores[, 1], pca.5$scores[, 2], pch = 18): Objekt 'pca.5' nicht gefunden\n\n# Subjektive Auswahl von Arten zur Darstellung\nsel.sp <- c(3, 11, 23, 39, 46, 72, 77, 96)\nsnames <- names(sveg[, sel.sp])\n## Error in eval(expr, envir, enclos): Objekt 'sveg' nicht gefunden\nsnames\n## Error in eval(expr, envir, enclos): Objekt 'snames' nicht gefunden\n\n# PCA-Plot der Korrelationen der Variablen (hier Arten) mit den Achsen (h)\nx <- pca.5$loadings[, 1]\n## Error in eval(expr, envir, enclos): Objekt 'pca.5' nicht gefunden\ny <- pca.5$loadings[, 2]\n## Error in eval(expr, envir, enclos): Objekt 'pca.5' nicht gefunden\nplot(x, y, type = \"n\", asp = 1)\n## Error in plot(x, y, type = \"n\", asp = 1): Objekt 'x' nicht gefunden\narrows(0, 0, x[sel.sp], y[sel.sp], length = 0.08)\n## Error in arrows(0, 0, x[sel.sp], y[sel.sp], length = 0.08): Objekt 'x' nicht gefunden\ntext(x[sel.sp], y[sel.sp], snames, pos = 1, cex = 0.6)\n## Error in text(x[sel.sp], y[sel.sp], snames, pos = 1, cex = 0.6): Objekt 'x' nicht gefunden\n\n# Mit vegan\npca.6 <- rda(sveg^0.25, scale = TRUE)\n## Error in rda(sveg^0.25, scale = TRUE): konnte Funktion \"rda\" nicht finden\n# Erklärte Varianz der Achsen\nsummary(pca.6, axes = 0)\n## Error in summary(pca.6, axes = 0): Objekt 'pca.6' nicht gefunden\n# PCA-Plot der Lage der Beobachtungen im Ordinationsraum\nbiplot(pca.6, display = \"sites\", type = \"points\", scaling = 1)\n## Error in biplot(pca.6, display = \"sites\", type = \"points\", scaling = 1): Objekt 'pca.6' nicht gefunden\n# Subjektive Auswahl von Arten zur Darstellung\nsel.sp <- c(3, 11, 23, 39, 46, 72, 77, 96)\nsnames <- names(sveg[, sel.sp])\n## Error in eval(expr, envir, enclos): Objekt 'sveg' nicht gefunden\nsnames\n## Error in eval(expr, envir, enclos): Objekt 'snames' nicht gefunden\n# PCA-Plot der Korrelationen der Variablen (hier Arten) mit den Achsen (h)\nscores <- scores(pca.6, display = \"species\")\n## Error in scores(pca.6, display = \"species\"): konnte Funktion \"scores\" nicht finden\nx <- scores[, 1]\n## Error in eval(expr, envir, enclos): Objekt 'scores' nicht gefunden\ny <- scores[, 2]\n## Error in eval(expr, envir, enclos): Objekt 'scores' nicht gefunden\nplot(x, y, type = \"n\", asp = 1)\n## Error in plot(x, y, type = \"n\", asp = 1): Objekt 'x' nicht gefunden\narrows(0, 0, x[sel.sp], y[sel.sp], length = 0.08)\n## Error in arrows(0, 0, x[sel.sp], y[sel.sp], length = 0.08): Objekt 'x' nicht gefunden\ntext(x[sel.sp], y[sel.sp], snames, pos = 1, cex = 0.6)\n## Error in text(x[sel.sp], y[sel.sp], snames, pos = 1, cex = 0.6): Objekt 'x' nicht gefunden\n\n# Mit angepassten Achsen\nplot(x, y, type = \"n\", asp = 1, xlim = c(-1, 1), ylim = c(-0.6, 0.6))\n## Error in plot(x, y, type = \"n\", asp = 1, xlim = c(-1, 1), ylim = c(-0.6, : Objekt 'x' nicht gefunden\narrows(0, 0, x[sel.sp], y[sel.sp], length = 0.08)\n## Error in arrows(0, 0, x[sel.sp], y[sel.sp], length = 0.08): Objekt 'x' nicht gefunden\ntext(x[sel.sp], y[sel.sp], snames, pos = 1, cex = 0.6)\n## Error in text(x[sel.sp], y[sel.sp], snames, pos = 1, cex = 0.6): Objekt 'x' nicht gefunden\n```\n:::\n\n\n### CA\n\n\n::: {.cell}\n\n```{.r .cell-code}\nca.1 <- cca(sveg^0.5)\n## Error in cca(sveg^0.5): konnte Funktion \"cca\" nicht finden\n# Arten (o) und Communities (+) plotten\nplot(ca.1)\n## Error in plot(ca.1): Objekt 'ca.1' nicht gefunden\n\n# Nur Arten plotten\nplot(ca.1, display = \"species\", type = \"points\")\n## Error in plot(ca.1, display = \"species\", type = \"points\"): Objekt 'ca.1' nicht gefunden\n\n# Anteilige Varianz, die durch die ersten beiden Achsen erklärt wird\nca.1$CA$eig[1:2] / sum(ca.1$CA$eig)\n## Error in eval(expr, envir, enclos): Objekt 'ca.1' nicht gefunden\n\nsummary(eigenvals(ca.1))\n## Error in eigenvals(ca.1): konnte Funktion \"eigenvals\" nicht finden\n```\n:::\n\n\n### DCA\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndca.1 <- decorana(sveg, mk = 10)\n## Error in decorana(sveg, mk = 10): konnte Funktion \"decorana\" nicht finden\nplot(dca.1, display = \"sites\", type = \"point\")\n## Error in plot(dca.1, display = \"sites\", type = \"point\"): Objekt 'dca.1' nicht gefunden\n\ndca.2 <- decorana(sveg, mk = 100)\n## Error in decorana(sveg, mk = 100): konnte Funktion \"decorana\" nicht finden\nplot(dca.2, display = \"sites\", type = \"point\")\n## Error in plot(dca.2, display = \"sites\", type = \"point\"): Objekt 'dca.2' nicht gefunden\n```\n:::\n\n\n### NMDS\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Distanzmatrix als Start erzeugen (PCA)\nmde <- vegdist(sveg, method = \"euclidean\")\n## Error in vegdist(sveg, method = \"euclidean\"): konnte Funktion \"vegdist\" nicht finden\n\n# Alternative mit einem für Vegetationsdaten häufig verwendeten Dissimilarity-index\nmde <- vegdist(sveg, method = \"bray\")\n## Error in vegdist(sveg, method = \"bray\"): konnte Funktion \"vegdist\" nicht finden\n\n# Z wei verschiedene NMDS-Methoden\nlibrary(\"MASS\")\nset.seed(1) # macht man, wenn man bei einer Wiederholung exakt die gleichen Ergebnisse will\nimds <- isoMDS(mde, k = 2)\n## Error in isoMDS(mde, k = 2): Objekt 'mde' nicht gefunden\nset.seed(1)\nmmds <- metaMDS(mde, k = 2)\n## Error in metaMDS(mde, k = 2): konnte Funktion \"metaMDS\" nicht finden\n\nplot(imds$points)\n## Error in plot(imds$points): Objekt 'imds' nicht gefunden\nplot(mmds$points)\n## Error in plot(mmds$points): Objekt 'mmds' nicht gefunden\n\n# Stress = S² = Abweichung der zweidimensionalen NMDS-Lösung von der originalen Distanzmatrix\nstressplot(imds, mde)\n## Error in stressplot(imds, mde): konnte Funktion \"stressplot\" nicht finden\nstressplot(mmds, mde)\n## Error in stressplot(mmds, mde): konnte Funktion \"stressplot\" nicht finden\n```\n:::\n",
    "supporting": [
      "Statistik6_Demo_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}