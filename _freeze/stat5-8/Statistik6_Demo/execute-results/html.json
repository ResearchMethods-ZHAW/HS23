{
  "hash": "1d21b8e9990088eceb95518ba48aa0ba",
  "result": {
    "markdown": "---\ndate: 2023-11-14\nlesson: Stat6\nthema: Einführung in \"multivariate\" Methoden\nindex: 1\nformat:\n  html:\n    code-tools:\n      source: true\n---\n\n\n# Stat6: Demo\n\n-   Download dieses Demoscript via \"\\</\\>Code\" (oben rechts)\n-   Datensatz *dave_sveg.csv* von @wildi2017data\n\n## Ordinationen I\n\n### PCA\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"labdsv\")\n\n# Für Ordinationen benötigen wir Matrizen, nicht Dataframes\n# Generieren von Daten\nraw <- matrix(c(1, 2, 2.5, 2.5, 1, 0.5, 0, 1, 2, 4, 3, 1), nrow = 6)\ncolnames(raw) <- c(\"Art1\", \"Art2\")\nrownames(raw) <- c(\"Ort1\", \"Ort2\", \"Ort3\", \"Ort4\", \"Ort5\", \"Ort6\")\nraw\n##      Art1 Art2\n## Ort1  1.0    0\n## Ort2  2.0    1\n## Ort3  2.5    2\n## Ort4  2.5    4\n## Ort5  1.0    3\n## Ort6  0.5    1\n\n# Originaldaten für Plot separieren\nx1 <- raw[, 1]\ny1 <- raw[, 2]\nz <- c(rep(1:6))\n\n# Plot Abhängigkeit der Arten vom Umweltgradienten\nplot(c(x1, y1) ~ c(z, z),\n  type = \"n\", axes = T, bty = \"l\",\n  las = 1, xlim = c(1, 6), ylim = c(0, 5),\n  xlab = \"Umweltgradient\", ylab = \"Deckung der Arten\"\n)\npoints(x1 ~ z, pch = 21, type = \"b\")\npoints(y1 ~ z, pch = 16, type = \"b\")\ntext(1.5, 1.5, \"Art 1\", col = \"darkgray\")\ntext(1.5, 0.5, \"Art 2\", col = \"darkgray\")\n```\n\n::: {.cell-output-display}\n![](Statistik6_Demo_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\n\n# Daten zentrieren\n# d.h. transformieren so, dass Mittelwert = 0\ncent <- scale(raw, scale = FALSE)\nx2 <- cent[, 1] # für nachfolgenden Plot speichern\ny2 <- cent[, 2] # für nachfolgenden Plot speichern\n\n# Daten zusätzlich rotieren\n# PCA zentriert und rotiert Daten\no.pca <- pca(raw)\nx3 <- o.pca$scores[, 1] # für nachfolgenden Plot speichern\ny3 <- o.pca$scores[, 2] # für nachfolgenden Plot speichern\n\n# Visualisierung der Schritte im Ordinationsraum\nplot(c(y1, y2, y3) ~ c(x1, x2, x3),\n  type = \"n\", axes = T, bty = \"l\", las = 1,\n  xlim = c(-4, 4), ylim = c(-4, 4), xlab = \"Art 1\", ylab = \"Art 2\"\n)\npoints(y1 ~ x1, pch = 21, type = \"b\", col = \"green\", lwd = 2)\ntext(-2.5, 4, \"Originaldaten\", col = \"green\")\npoints(y2 ~ x2, pch = 16, type = \"b\", col = \"red\", lwd = 2)\ntext(-2.5, 3.5, \"Zentriert\", col = \"red\")\npoints(y3 ~ x3, pch = 17, type = \"b\", col = \"blue\", lwd = 2)\ntext(-2.5, 3, \"Zentriert & rotiert\", col = \"blue\")\n```\n\n::: {.cell-output-display}\n![](Statistik6_Demo_files/figure-html/unnamed-chunk-1-2.png){width=672}\n:::\n\n```{.r .cell-code}\n\n# Durchführung der PCA\no.pca <- pca(raw)\nplot(o.pca)\n```\n\n::: {.cell-output-display}\n![](Statistik6_Demo_files/figure-html/unnamed-chunk-1-3.png){width=672}\n:::\n\n```{.r .cell-code}\n\n# Koordinaten im Ordinationsraum\no.pca$scores\n##             PC1         PC2\n## Ort1 -1.9216223 -0.09357697\n## Ort2 -0.6353776 -0.68143293\n## Ort3  0.4762699 -0.80076373\n## Ort4  2.3503705 -0.10237502\n## Ort5  0.8895287  0.95400610\n## Ort6 -1.1591692  0.72414255\n\n# Korrelationen der Variablen mit den Ordinationsachsen\no.pca$loadings\n##            PC1        PC2\n## Art1 0.3491944 -0.9370503\n## Art2 0.9370503  0.3491944\n\n# Erklärte Varianz der Achsen\nE <- o.pca$sdev^2 / o.pca$totdev * 100\nE\n## [1] 82.40009 17.59991\n\n# Visualisieren mit prcomp\npca.2 <- prcomp(raw, scale = F)\nsummary(pca.2)\n## Importance of components:\n##                          PC1    PC2\n## Standard deviation     1.548 0.7154\n## Proportion of Variance 0.824 0.1760\n## Cumulative Proportion  0.824 1.0000\nplot(pca.2) #\n```\n\n::: {.cell-output-display}\n![](Statistik6_Demo_files/figure-html/unnamed-chunk-1-4.png){width=672}\n:::\n\n```{.r .cell-code}\nbiplot(pca.2)\n```\n\n::: {.cell-output-display}\n![](Statistik6_Demo_files/figure-html/unnamed-chunk-1-5.png){width=672}\n:::\n\n```{.r .cell-code}\n\n# mit vegan\nlibrary(\"vegan\")\n# Die Funktion rda führt ein PCA aus an wenn nicht Artdaten UND Umweltdaten definiert werden\npca.3 <- rda(raw, scale = FALSE)\n# scores(pca.3, display = c(\"sites\"))\n# scores(pca.3, display = c(\"species\"))\nsummary(pca.3, axes = 0)\n## \n## Call:\n## rda(X = raw, scale = FALSE) \n## \n## Partitioning of variance:\n##               Inertia Proportion\n## Total           2.908          1\n## Unconstrained   2.908          1\n## \n## Eigenvalues, and their contribution to the variance \n## \n## Importance of components:\n##                         PC1    PC2\n## Eigenvalue            2.396 0.5119\n## Proportion Explained  0.824 0.1760\n## Cumulative Proportion 0.824 1.0000\n## \n## Scaling 2 for species and site scores\n## * Species are scaled proportional to eigenvalues\n## * Sites are unscaled: weighted dispersion equal on all dimensions\n## * General scaling constant of scores:\nbiplot(pca.3)\n```\n\n::: {.cell-output-display}\n![](Statistik6_Demo_files/figure-html/unnamed-chunk-1-6.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Mit Beispieldaten aus Wildi\nlibrary(\"readr\")\nsveg <- read_delim(\"datasets/stat5-8/dave_sveg.csv\")\n## Error: 'datasets/stat5-8/dave_sveg.csv' does not exist in current working directory ('C:/Users/luoe/Documents/Coding/Research Methods/HS23').\n\nstr(sveg)\n## Error in str(sveg): object 'sveg' not found\nsummary(sveg)\n## Error in summary(sveg): object 'sveg' not found\nnames(sveg)\n## Error in eval(expr, envir, enclos): object 'sveg' not found\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# PCA: Deckungen Wurzeltransformiert, cor=TRUE erzwingt Nutzung der Korrelationsmatrix\npca.5 <- pca(sveg^0.25, cor = TRUE)\n## Error in prcomp(mat, retx = TRUE, center = TRUE, scale = cor): object 'sveg' not found\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Koordinaten im Ordinationsraum\npca.5$scores\n\n# Korrelationen der Variablen mit den Ordinationsachsen\npca.5$loadings\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Erklärte Varianz der Achsen in Prozent (sdev ist die Wurzel daraus)\nE <- pca.5$sdev^2 / pca.5$totdev * 100\n## Error in eval(expr, envir, enclos): object 'pca.5' not found\nE\n## [1] 82.40009 17.59991\nE[1:5]\n## [1] 82.40009 17.59991       NA       NA       NA\nplot(pca.5)\n## Error in plot(pca.5): object 'pca.5' not found\n# PCA-Plot der Lage der Beobachtungen im Ordinationsraum\nplot(pca.5$scores[, 1], pca.5$scores[, 2], type = \"n\", asp = 1, xlab = \"PC1\", ylab = \"PC2\")\n## Error in plot(pca.5$scores[, 1], pca.5$scores[, 2], type = \"n\", asp = 1, : object 'pca.5' not found\npoints(pca.5$scores[, 1], pca.5$scores[, 2], pch = 18)\n## Error in points(pca.5$scores[, 1], pca.5$scores[, 2], pch = 18): object 'pca.5' not found\n\n# Subjektive Auswahl von Arten zur Darstellung\nsel.sp <- c(3, 11, 23, 39, 46, 72, 77, 96)\nsnames <- names(sveg[, sel.sp])\n## Error in eval(expr, envir, enclos): object 'sveg' not found\nsnames\n## Error in eval(expr, envir, enclos): object 'snames' not found\n\n# PCA-Plot der Korrelationen der Variablen (hier Arten) mit den Achsen (h)\nx <- pca.5$loadings[, 1]\n## Error in eval(expr, envir, enclos): object 'pca.5' not found\ny <- pca.5$loadings[, 2]\n## Error in eval(expr, envir, enclos): object 'pca.5' not found\nplot(x, y, type = \"n\", asp = 1)\n## Error in plot(x, y, type = \"n\", asp = 1): object 'x' not found\narrows(0, 0, x[sel.sp], y[sel.sp], length = 0.08)\n## Error in arrows(0, 0, x[sel.sp], y[sel.sp], length = 0.08): object 'x' not found\ntext(x[sel.sp], y[sel.sp], snames, pos = 1, cex = 0.6)\n## Error in text(x[sel.sp], y[sel.sp], snames, pos = 1, cex = 0.6): object 'x' not found\n\n# Mit vegan\npca.6 <- rda(sveg^0.25, scale = TRUE)\n## Error in rda(sveg^0.25, scale = TRUE): object 'sveg' not found\n# Erklärte Varianz der Achsen\nsummary(pca.6, axes = 0)\n## Error in summary(pca.6, axes = 0): object 'pca.6' not found\n# PCA-Plot der Lage der Beobachtungen im Ordinationsraum\nbiplot(pca.6, display = \"sites\", type = \"points\", scaling = 1)\n## Error in biplot(pca.6, display = \"sites\", type = \"points\", scaling = 1): object 'pca.6' not found\n# Subjektive Auswahl von Arten zur Darstellung\nsel.sp <- c(3, 11, 23, 39, 46, 72, 77, 96)\nsnames <- names(sveg[, sel.sp])\n## Error in eval(expr, envir, enclos): object 'sveg' not found\nsnames\n## Error in eval(expr, envir, enclos): object 'snames' not found\n# PCA-Plot der Korrelationen der Variablen (hier Arten) mit den Achsen (h)\nscores <- scores(pca.6, display = \"species\")\n## Error in scores(pca.6, display = \"species\"): object 'pca.6' not found\nx <- scores[, 1]\n## Error in scores[, 1]: object of type 'closure' is not subsettable\ny <- scores[, 2]\n## Error in scores[, 2]: object of type 'closure' is not subsettable\nplot(x, y, type = \"n\", asp = 1)\n## Error in plot(x, y, type = \"n\", asp = 1): object 'x' not found\narrows(0, 0, x[sel.sp], y[sel.sp], length = 0.08)\n## Error in arrows(0, 0, x[sel.sp], y[sel.sp], length = 0.08): object 'x' not found\ntext(x[sel.sp], y[sel.sp], snames, pos = 1, cex = 0.6)\n## Error in text(x[sel.sp], y[sel.sp], snames, pos = 1, cex = 0.6): object 'x' not found\n\n# Mit angepassten Achsen\nplot(x, y, type = \"n\", asp = 1, xlim = c(-1, 1), ylim = c(-0.6, 0.6))\n## Error in plot(x, y, type = \"n\", asp = 1, xlim = c(-1, 1), ylim = c(-0.6, : object 'x' not found\narrows(0, 0, x[sel.sp], y[sel.sp], length = 0.08)\n## Error in arrows(0, 0, x[sel.sp], y[sel.sp], length = 0.08): object 'x' not found\ntext(x[sel.sp], y[sel.sp], snames, pos = 1, cex = 0.6)\n## Error in text(x[sel.sp], y[sel.sp], snames, pos = 1, cex = 0.6): object 'x' not found\n```\n:::\n\n\n### CA\n\n\n::: {.cell}\n\n```{.r .cell-code}\nca.1 <- cca(sveg^0.5)\n## Error in cca(sveg^0.5): object 'sveg' not found\n# Arten (o) und Communities (+) plotten\nplot(ca.1)\n## Error in plot(ca.1): object 'ca.1' not found\n\n# Nur Arten plotten\nplot(ca.1, display = \"species\", type = \"points\")\n## Error in plot(ca.1, display = \"species\", type = \"points\"): object 'ca.1' not found\n\n# Anteilige Varianz, die durch die ersten beiden Achsen erklärt wird\nca.1$CA$eig[1:2] / sum(ca.1$CA$eig)\n## Error in eval(expr, envir, enclos): object 'ca.1' not found\n\nsummary(eigenvals(ca.1))\n## Error in eigenvals(ca.1): object 'ca.1' not found\n```\n:::\n\n\n### DCA\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndca.1 <- decorana(sveg, mk = 10)\n## Error in as.matrix(veg): object 'sveg' not found\nplot(dca.1, display = \"sites\", type = \"point\")\n## Error in plot(dca.1, display = \"sites\", type = \"point\"): object 'dca.1' not found\n\ndca.2 <- decorana(sveg, mk = 100)\n## Error in as.matrix(veg): object 'sveg' not found\nplot(dca.2, display = \"sites\", type = \"point\")\n## Error in plot(dca.2, display = \"sites\", type = \"point\"): object 'dca.2' not found\n```\n:::\n\n\n### NMDS\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Distanzmatrix als Start erzeugen (PCA)\nmde <- vegdist(sveg, method = \"euclidean\")\n## Error in as.matrix(x): object 'sveg' not found\n\n# Alternative mit einem für Vegetationsdaten häufig verwendeten Dissimilarity-index\nmde <- vegdist(sveg, method = \"bray\")\n## Error in as.matrix(x): object 'sveg' not found\n\n# Z wei verschiedene NMDS-Methoden\nlibrary(\"MASS\")\nset.seed(1) # macht man, wenn man bei einer Wiederholung exakt die gleichen Ergebnisse will\nimds <- isoMDS(mde, k = 2)\n## Error in isoMDS(mde, k = 2): object 'mde' not found\nset.seed(1)\nmmds <- metaMDS(mde, k = 2)\n## Error in metaMDS(mde, k = 2): object 'mde' not found\n\nplot(imds$points)\n## Error in plot(imds$points): object 'imds' not found\nplot(mmds$points)\n## Error in plot(mmds$points): object 'mmds' not found\n\n# Stress = S² = Abweichung der zweidimensionalen NMDS-Lösung von der originalen Distanzmatrix\nstressplot(imds, mde)\n## Error in stressplot(imds, mde): object 'imds' not found\nstressplot(mmds, mde)\n## Error in stressplot(mmds, mde): object 'mmds' not found\n```\n:::\n",
    "supporting": [
      "Statistik6_Demo_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}