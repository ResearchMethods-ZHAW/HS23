{
  "hash": "a3832cd2191c1afb5c4c41f7068df3e0",
  "result": {
    "markdown": "---\ndate: 2023-11-21\nlesson: Stat8\nthema: Clusteranalysen\nindex: 1\nformat:\n  html:\n    code-tools:\n      source: true\n---\n\n\n# Stat8: Demo\n\n-   Download dieses Demoscript via \"\\</\\>Code\" (oben rechts)\n-   Datensatz *Doubs.RData*\n-   Funktion drawmap.R [drawmap.R](drawmap.R)\n-   Funktion hcoplot.R [hcoplot.R](hcoplot.R)\n\n## k-means clustering\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Das Moordatenset sveg laden\nlibrary(\"dave\")\n## Error in library(\"dave\"): es gibt kein Paket namens 'dave'\n\n# PCA und CA rechnen\npca <- rda(sveg^0.25, scale = TRUE)\n## Error in rda(sveg^0.25, scale = TRUE): konnte Funktion \"rda\" nicht finden\nca <- cca(sveg^0.5)\n## Error in cca(sveg^0.5): konnte Funktion \"cca\" nicht finden\n\n# k-means-Clustering mit 4 Gruppen durchführen\nkmeans.1 <- kmeans(sveg, 4)\n## Error in as.matrix(x): Objekt 'sveg' nicht gefunden\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Clustering-Resultat in Ordinationsplots darstellen\nplot(ca, type = \"n\")\n## Error in plot(ca, type = \"n\"): Objekt 'ca' nicht gefunden\npoints(ca, display = \"sites\", pch=19, col = kmeans.1[[1]])\n## Error in points(ca, display = \"sites\", pch = 19, col = kmeans.1[[1]]): Objekt 'ca' nicht gefunden\n\n# k-means Clustering mit 3 Clusters\nkmeans.2 <- kmeans(sveg, 3)\n## Error in as.matrix(x): Objekt 'sveg' nicht gefunden\nplot(pca, type = \"n\")\n## Error in plot(pca, type = \"n\"): Objekt 'pca' nicht gefunden\npoints(pca, display = \"sites\", pch=19, col = kmeans.2[[1]])\n## Error in points(pca, display = \"sites\", pch = 19, col = kmeans.2[[1]]): Objekt 'pca' nicht gefunden\n\n# mit 3. Achse darstellen\nplot(pca, choices = c(1, 3), type = \"n\")\n## Error in plot(pca, choices = c(1, 3), type = \"n\"): Objekt 'pca' nicht gefunden\npoints(pca, choices = c(1, 3), display = \"sites\", pch = 19, col=kmeans.2[[1]])\n## Error in points(pca, choices = c(1, 3), display = \"sites\", pch = 19, col = kmeans.2[[1]]): Objekt 'pca' nicht gefunden\n\n# k-means partitioning, 2 to 10 groups\nKM.cascade <- cascadeKM(sveg,  inf.gr = 2, sup.gr = 10, iter = 100, criterion = \"ssi\")\n## Error in cascadeKM(sveg, inf.gr = 2, sup.gr = 10, iter = 100, criterion = \"ssi\"): konnte Funktion \"cascadeKM\" nicht finden\nsummary(KM.cascade)\n## Error in summary(KM.cascade): Objekt 'KM.cascade' nicht gefunden\nKM.cascade$results\n## Error in eval(expr, envir, enclos): Objekt 'KM.cascade' nicht gefunden\nKM.cascade$partition\n## Error in eval(expr, envir, enclos): Objekt 'KM.cascade' nicht gefunden\n\n# k-means visualisation\nplot(KM.cascade, sortg = TRUE)\n## Error in plot(KM.cascade, sortg = TRUE): Objekt 'KM.cascade' nicht gefunden\n```\n:::\n\n\n## Agglomarative Clusteranalyse\n\nmit Daten und Skripten aus @borcard2011\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Daten laden\nload(\"datasets/stat5-8/Doubs.RData\")  \n## Error in readChar(con, 5L, useBytes = TRUE): kann Verbindung nicht öffnen\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Remove empty site 8\nspe <- spe[-8, ]\n## Error in eval(expr, envir, enclos): Objekt 'spe' nicht gefunden\nenv <- env[-8, ]\n## Error in eval(expr, envir, enclos): Objekt 'env' nicht gefunden\nspa <- spa[-8, ]\n## Error in eval(expr, envir, enclos): Objekt 'spa' nicht gefunden\nlatlong <- latlong[-8, ]\n## Error in eval(expr, envir, enclos): Objekt 'latlong' nicht gefunden\n```\n:::\n\n\n## Dendogramme berechnen und ploten\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Hierarchical agglomerative clustering of the species abundance \n\n# Compute matrix of chord distance among sites\nspe.norm <- decostand(spe, \"normalize\")\n## Error in decostand(spe, \"normalize\"): konnte Funktion \"decostand\" nicht finden\nspe.ch <- vegdist(spe.norm, \"euc\")\n## Error in vegdist(spe.norm, \"euc\"): konnte Funktion \"vegdist\" nicht finden\n\n# Attach site names to object of class 'dist'\nattr(spe.ch, \"Labels\") <- rownames(spe)\n## Error in rownames(spe): Objekt 'spe' nicht gefunden\n\npar(mfrow = c(1, 1))\n\n# Compute single linkage agglomerative clustering\nspe.ch.single <- hclust(spe.ch, method = \"single\")\n## Error in hclust(spe.ch, method = \"single\"): Objekt 'spe.ch' nicht gefunden\n# Plot a dendrogram using the default options\nplot(spe.ch.single, labels = rownames(spe), main = \"Chord - Single linkage\")\n## Error in plot(spe.ch.single, labels = rownames(spe), main = \"Chord - Single linkage\"): Objekt 'spe.ch.single' nicht gefunden\n\n# Compute complete-linkage agglomerative clustering\nspe.ch.complete <- hclust(spe.ch, method = \"complete\")\n## Error in hclust(spe.ch, method = \"complete\"): Objekt 'spe.ch' nicht gefunden\nplot(spe.ch.complete, labels = rownames(spe), main = \"Chord - Complete linkage\")\n## Error in plot(spe.ch.complete, labels = rownames(spe), main = \"Chord - Complete linkage\"): Objekt 'spe.ch.complete' nicht gefunden\n\n# Compute UPGMA agglomerative clustering\nspe.ch.UPGMA <- hclust(spe.ch, method = \"average\")\n## Error in hclust(spe.ch, method = \"average\"): Objekt 'spe.ch' nicht gefunden\nplot(spe.ch.UPGMA, labels = rownames(spe), main = \"Chord - UPGMA\")\n## Error in plot(spe.ch.UPGMA, labels = rownames(spe), main = \"Chord - UPGMA\"): Objekt 'spe.ch.UPGMA' nicht gefunden\n\n# Compute centroid clustering\nspe.ch.centroid <- hclust(spe.ch, method = \"centroid\")\n## Error in hclust(spe.ch, method = \"centroid\"): Objekt 'spe.ch' nicht gefunden\nplot(spe.ch.centroid, labels = rownames(spe),  main = \"Chord - Centroid\")\n## Error in plot(spe.ch.centroid, labels = rownames(spe), main = \"Chord - Centroid\"): Objekt 'spe.ch.centroid' nicht gefunden\n\n# Compute Ward's minimum variance clustering\nspe.ch.ward <-hclust(spe.ch, method = \"ward.D2\")\n## Error in hclust(spe.ch, method = \"ward.D2\"): Objekt 'spe.ch' nicht gefunden\nplot(spe.ch.ward, labels = rownames(spe),  main = \"Chord - Ward\")\n## Error in plot(spe.ch.ward, labels = rownames(spe), main = \"Chord - Ward\"): Objekt 'spe.ch.ward' nicht gefunden\n\n# Compute beta-flexible clustering using cluster::agnes()\n# beta = -0.1\nspe.ch.beta1 <- agnes(spe.ch, method = \"flexible\", par.method = 0.55)\n## Error in agnes(spe.ch, method = \"flexible\", par.method = 0.55): konnte Funktion \"agnes\" nicht finden\n# beta = -0.25\nspe.ch.beta2 <- agnes(spe.ch, method = \"flexible\", par.method = 0.625)\n## Error in agnes(spe.ch, method = \"flexible\", par.method = 0.625): konnte Funktion \"agnes\" nicht finden\n# beta = -0.5\nspe.ch.beta3 <- agnes(spe.ch, method = \"flexible\", par.method = 0.75)\n## Error in agnes(spe.ch, method = \"flexible\", par.method = 0.75): konnte Funktion \"agnes\" nicht finden\n# Change the class of agnes objects\nclass(spe.ch.beta1)\n## Error in eval(expr, envir, enclos): Objekt 'spe.ch.beta1' nicht gefunden\nspe.ch.beta1 <- as.hclust(spe.ch.beta1)\n## Error in as.hclust(spe.ch.beta1): Objekt 'spe.ch.beta1' nicht gefunden\nclass(spe.ch.beta1)\n## Error in eval(expr, envir, enclos): Objekt 'spe.ch.beta1' nicht gefunden\nspe.ch.beta2 <- as.hclust(spe.ch.beta2)\n## Error in as.hclust(spe.ch.beta2): Objekt 'spe.ch.beta2' nicht gefunden\nspe.ch.beta3 <- as.hclust(spe.ch.beta3)\n## Error in as.hclust(spe.ch.beta3): Objekt 'spe.ch.beta3' nicht gefunden\n\npar(mfrow = c(2, 2))\nplot(spe.ch.beta1, labels = rownames(spe), main = \"Chord - Beta-flexible (beta=-0.1)\")\n## Error in plot(spe.ch.beta1, labels = rownames(spe), main = \"Chord - Beta-flexible (beta=-0.1)\"): Objekt 'spe.ch.beta1' nicht gefunden\nplot(spe.ch.beta2, labels = rownames(spe), main = \"Chord - Beta-flexible (beta=-0.25)\")\n## Error in plot(spe.ch.beta2, labels = rownames(spe), main = \"Chord - Beta-flexible (beta=-0.25)\"): Objekt 'spe.ch.beta2' nicht gefunden\nplot(spe.ch.beta3,  labels = rownames(spe),  main = \"Chord - Beta-flexible (beta=-0.5)\")\n## Error in plot(spe.ch.beta3, labels = rownames(spe), main = \"Chord - Beta-flexible (beta=-0.5)\"): Objekt 'spe.ch.beta3' nicht gefunden\n\n# Compute Ward's minimum variance clustering\nspe.ch.ward <- hclust(spe.ch, method = \"ward.D2\")\n## Error in hclust(spe.ch, method = \"ward.D2\"): Objekt 'spe.ch' nicht gefunden\nplot(spe.ch.ward, labels = rownames(spe), main = \"Chord - Ward\")\n## Error in plot(spe.ch.ward, labels = rownames(spe), main = \"Chord - Ward\"): Objekt 'spe.ch.ward' nicht gefunden\n```\n:::\n\n\n## Cophenetic correlations\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Single linkage clustering\nspe.ch.single.coph <- cophenetic(spe.ch.single)\n## Error in cophenetic(spe.ch.single): Objekt 'spe.ch.single' nicht gefunden\ncor(spe.ch, spe.ch.single.coph)\n## Error in is.data.frame(y): Objekt 'spe.ch.single.coph' nicht gefunden\n\n# Complete linkage clustering\nspe.ch.comp.coph <- cophenetic(spe.ch.complete)\n## Error in cophenetic(spe.ch.complete): Objekt 'spe.ch.complete' nicht gefunden\ncor(spe.ch, spe.ch.comp.coph)\n## Error in is.data.frame(y): Objekt 'spe.ch.comp.coph' nicht gefunden\n\n# Average clustering\nspe.ch.UPGMA.coph <- cophenetic(spe.ch.UPGMA)\n## Error in cophenetic(spe.ch.UPGMA): Objekt 'spe.ch.UPGMA' nicht gefunden\ncor(spe.ch, spe.ch.UPGMA.coph)\n## Error in is.data.frame(y): Objekt 'spe.ch.UPGMA.coph' nicht gefunden\n\n# Ward clustering\nspe.ch.ward.coph <- cophenetic(spe.ch.ward)\n## Error in cophenetic(spe.ch.ward): Objekt 'spe.ch.ward' nicht gefunden\ncor(spe.ch, spe.ch.ward.coph)\n## Error in is.data.frame(y): Objekt 'spe.ch.ward.coph' nicht gefunden\n\n# Shepard-like diagrams\npar(mfrow = c(2, 2))\nplot(spe.ch, spe.ch.single.coph,\n  xlab = \"Chord distance\", ylab = \"Cophenetic distance\",\n  asp = 1, xlim = c(0, sqrt(2)), ylim = c(0, sqrt(2)),\n  main = c(\"Single linkage\", paste(\"Cophenetic correlation =\",\n                                   round(cor(spe.ch, spe.ch.single.coph), 3))))\n## Error in plot(spe.ch, spe.ch.single.coph, xlab = \"Chord distance\", ylab = \"Cophenetic distance\", : Objekt 'spe.ch' nicht gefunden\nabline(0, 1)\n## Error in int_abline(a = a, b = b, h = h, v = v, untf = untf, ...): plot.new has not been called yet\nlines(lowess(spe.ch, spe.ch.single.coph), col = \"red\")\n## Error in xy.coords(x, y, setLab = FALSE): Objekt 'spe.ch.single.coph' nicht gefunden\n\nplot(spe.ch, spe.ch.comp.coph,\n  xlab = \"Chord distance\", ylab = \"Cophenetic distance\",\n  asp = 1, xlim = c(0, sqrt(2)), ylim = c(0, sqrt(2)),\n  main = c(\"Complete linkage\", paste(\"Cophenetic correlation =\",\n                                     round(cor(spe.ch, spe.ch.comp.coph), 3))))\n## Error in plot(spe.ch, spe.ch.comp.coph, xlab = \"Chord distance\", ylab = \"Cophenetic distance\", : Objekt 'spe.ch' nicht gefunden\nabline(0, 1)\n## Error in int_abline(a = a, b = b, h = h, v = v, untf = untf, ...): plot.new has not been called yet\nlines(lowess(spe.ch, spe.ch.comp.coph), col = \"red\")\n## Error in xy.coords(x, y, setLab = FALSE): Objekt 'spe.ch.comp.coph' nicht gefunden\n\nplot(spe.ch, spe.ch.UPGMA.coph,\n  xlab = \"Chord distance\", ylab = \"Cophenetic distance\",\n  asp = 1, xlim = c(0, sqrt(2)), ylim = c(0, sqrt(2)),\n  main = c(\"UPGMA\", paste(\"Cophenetic correlation =\",\n                          round( cor(spe.ch, spe.ch.UPGMA.coph), 3))))\n## Error in plot(spe.ch, spe.ch.UPGMA.coph, xlab = \"Chord distance\", ylab = \"Cophenetic distance\", : Objekt 'spe.ch' nicht gefunden\nabline(0, 1)\n## Error in int_abline(a = a, b = b, h = h, v = v, untf = untf, ...): plot.new has not been called yet\nlines(lowess(spe.ch, spe.ch.UPGMA.coph), col = \"red\")\n## Error in xy.coords(x, y, setLab = FALSE): Objekt 'spe.ch.UPGMA.coph' nicht gefunden\n\nplot(spe.ch, spe.ch.ward.coph,\n  xlab = \"Chord distance\", ylab = \"Cophenetic distance\",\n  asp = 1, xlim = c(0, sqrt(2)), ylim = c(0, max(spe.ch.ward$height)),\n  main = c(\"Ward\", paste(\"Cophenetic correlation =\", \n                         round(cor(spe.ch, spe.ch.ward.coph), 3))))\n## Error in plot(spe.ch, spe.ch.ward.coph, xlab = \"Chord distance\", ylab = \"Cophenetic distance\", : Objekt 'spe.ch' nicht gefunden\nabline(0, 1)\n## Error in int_abline(a = a, b = b, h = h, v = v, untf = untf, ...): plot.new has not been called yet\nlines(lowess(spe.ch, spe.ch.ward.coph), col = \"red\")\n## Error in xy.coords(x, y, setLab = FALSE): Objekt 'spe.ch.ward.coph' nicht gefunden\n```\n:::\n\n\n## Optimale Anzahl Cluster\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Select a dendrogram (Ward/chord) and apply three criteria\n## to choose the optimal number of clusters\n\n# Choose and rename the dendrogram (\"hclust\" object)\nhc <- spe.ch.ward\n## Error in eval(expr, envir, enclos): Objekt 'spe.ch.ward' nicht gefunden\n# hc <- spe.ch.beta2\n# hc <- spe.ch.complete\n\npar(mfrow = c(1, 2))\n\n# Average silhouette widths (Rousseeuw quality index)\nSi <- numeric(nrow(spe))\n## Error in nrow(spe): Objekt 'spe' nicht gefunden\nfor (k in 2:(nrow(spe) - 1))\n{\n  sil <- silhouette(cutree(hc, k = k), spe.ch)\n  Si[k] <- summary(sil)$avg.width\n}\n## Error in nrow(spe): Objekt 'spe' nicht gefunden\n\nk.best <- which.max(Si)\n## Error in which.max(Si): Objekt 'Si' nicht gefunden\nplot(1:nrow(spe), Si, type = \"h\",\n  main = \"Silhouette-optimal number of clusters\",\n  xlab = \"k (number of clusters)\", ylab = \"Average silhouette width\")\n## Error in nrow(spe): Objekt 'spe' nicht gefunden\naxis(1, k.best,paste(\"optimum\", k.best, sep = \"\\n\"), col = \"red\", \n  font = 2, col.axis = \"red\")\n## Error in axis(1, k.best, paste(\"optimum\", k.best, sep = \"\\n\"), col = \"red\", : Objekt 'k.best' nicht gefunden\npoints(k.best,max(Si), pch = 16, col = \"red\",cex = 1.5)\n## Error in points(k.best, max(Si), pch = 16, col = \"red\", cex = 1.5): Objekt 'k.best' nicht gefunden\n\n# Optimal number of clusters according to matrix correlation \n# statistic (Pearson)\n\n# Homemade function grpdist from Borcard et al. (2018)\ngrpdist <- function(X)\n{\n  require(cluster)\n  veg <- as.data.frame(as.factor(X))\n  distgr <- daisy(veg, \"gower\")\n  distgr\n} \n\nkt <- data.frame(k = 1:nrow(spe), r = 0)\n## Error in nrow(spe): Objekt 'spe' nicht gefunden\nfor (i in 2:(nrow(spe) - 1)) \n{\n  gr <- cutree(hc, i)\n  distgr <- grpdist(gr)\n  mt <- cor(spe.ch, distgr, method = \"pearson\")\n  kt[i, 2] <- mt\n}\n## Error in nrow(spe): Objekt 'spe' nicht gefunden\n\nk.best <- which.max(kt$r)\n## Error in which.max(kt$r): Objekt 'kt' nicht gefunden\nplot(kt$k,kt$r, type = \"h\",\n  main = \"Matrix correlation-optimal number of clusters\",\n  xlab = \"k (number of clusters)\", ylab = \"Pearson's correlation\")\n## Error in plot(kt$k, kt$r, type = \"h\", main = \"Matrix correlation-optimal number of clusters\", : Objekt 'kt' nicht gefunden\naxis(1, k.best, paste(\"optimum\", k.best, sep = \"\\n\"),\n  col = \"red\", font = 2, col.axis = \"red\")\n## Error in axis(1, k.best, paste(\"optimum\", k.best, sep = \"\\n\"), col = \"red\", : Objekt 'k.best' nicht gefunden\npoints(k.best, max(kt$r), pch = 16, col = \"red\", cex = 1.5)\n## Error in points(k.best, max(kt$r), pch = 16, col = \"red\", cex = 1.5): Objekt 'k.best' nicht gefunden\n\n# Optimal number of clusters according as per indicator species\n# analysis (IndVal, Dufrene-Legendre; package: labdsv)\nIndVal <- numeric(nrow(spe))\n## Error in nrow(spe): Objekt 'spe' nicht gefunden\nng <- numeric(nrow(spe))\n## Error in nrow(spe): Objekt 'spe' nicht gefunden\nfor (k in 2:(nrow(spe) - 1))\n{\n  iva <- indval(spe, cutree(hc, k = k), numitr = 1000)\n  gr <- factor(iva$maxcls[iva$pval <= 0.05])\n  ng[k] <- length(levels(gr)) / k\n  iv <- iva$indcls[iva$pval <= 0.05]\n  IndVal[k] <- sum(iv)\n}\n## Error in nrow(spe): Objekt 'spe' nicht gefunden\n\nk.best <- which.max(IndVal[ng == 1]) + 1\n## Error in which.max(IndVal[ng == 1]): Objekt 'IndVal' nicht gefunden\ncol3 <- rep(1, nrow(spe))\n## Error in nrow(spe): Objekt 'spe' nicht gefunden\ncol3[ng == 1] <- 3\n## Error in col3[ng == 1] <- 3: Objekt 'col3' nicht gefunden\n\npar(mfrow = c(1, 2))\nplot(1:nrow(spe), IndVal, type = \"h\",\n  main = \"IndVal-optimal number of clusters\",\n  xlab = \"k (number of clusters)\", ylab = \"IndVal sum\", col = col3)\n## Error in nrow(spe): Objekt 'spe' nicht gefunden\naxis(1,k.best,paste(\"optimum\", k.best, sep = \"\\n\"),\n  col = \"red\", font = 2, col.axis = \"red\")\n## Error in axis(1, k.best, paste(\"optimum\", k.best, sep = \"\\n\"), col = \"red\", : Objekt 'k.best' nicht gefunden\n\npoints(which.max(IndVal),max(IndVal),pch = 16,col = \"red\",cex = 1.5)\n## Error in which.max(IndVal): Objekt 'IndVal' nicht gefunden\ntext(28, 15.7, \"a\", cex = 1.8)\n## Error in text.default(28, 15.7, \"a\", cex = 1.8): plot.new has not been called yet\n\nplot(1:nrow(spe),ng,\n  type = \"h\",\n  xlab = \"k (number of clusters)\",\n  ylab = \"Ratio\",\n  main = \"Proportion of clusters with significant indicator species\",\n  col = col3)\n## Error in nrow(spe): Objekt 'spe' nicht gefunden\naxis(1,k.best,paste(\"optimum\", k.best, sep = \"\\n\"),\n     col = \"red\", font = 2, col.axis = \"red\")\n## Error in axis(1, k.best, paste(\"optimum\", k.best, sep = \"\\n\"), col = \"red\", : Objekt 'k.best' nicht gefunden\npoints(k.best,max(ng), pch = 16, col = \"red\", cex = 1.5)\n## Error in points(k.best, max(ng), pch = 16, col = \"red\", cex = 1.5): Objekt 'k.best' nicht gefunden\ntext(28, 0.98, \"b\", cex = 1.8)\n## Error in text.default(28, 0.98, \"b\", cex = 1.8): plot.new has not been called yet\n```\n:::\n\n\n## Final dendrogram with the selected clusters\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Choose the number of clusters\nk <- 4\n# Silhouette plot of the final partition\nspech.ward.g <- cutree(spe.ch.ward, k = k)\n## Error in nrow(tree$merge): Objekt 'spe.ch.ward' nicht gefunden\nsil <- silhouette(spech.ward.g, spe.ch)\n## Error in silhouette(spech.ward.g, spe.ch): konnte Funktion \"silhouette\" nicht finden\nrownames(sil) <- row.names(spe)\n## Error in row.names(spe): Objekt 'spe' nicht gefunden\n\nplot(sil, main = \"Silhouette plot - Chord - Ward\", cex.names = 0.8, col = 2:(k + 1), nmax = 100)\n## Error in plot(sil, main = \"Silhouette plot - Chord - Ward\", cex.names = 0.8, : Objekt 'sil' nicht gefunden\n\n# Reorder clusters\nlibrary(\"gclus\")\n## Error in library(\"gclus\"): es gibt kein Paket namens 'gclus'\nspe.chwo <- reorder.hclust(spe.ch.ward, spe.ch)\n## Error in reorder.hclust(spe.ch.ward, spe.ch): konnte Funktion \"reorder.hclust\" nicht finden\n\n# Plot reordered dendrogram with group labels\npar(mfrow = c(1, 1))\nplot(spe.chwo, hang = -1, xlab = \"4 groups\", ylab = \"Height\", sub = \"\",\n  main = \"Chord - Ward (reordered)\", labels = cutree(spe.chwo, k = k))\n## Error in plot(spe.chwo, hang = -1, xlab = \"4 groups\", ylab = \"Height\", : Objekt 'spe.chwo' nicht gefunden\nrect.hclust(spe.chwo, k = k)\n## Error in rect.hclust(spe.chwo, k = k): Objekt 'spe.chwo' nicht gefunden\n\n# Plot the final dendrogram with group colors (RGBCMY...)\n# Fast method using the additional hcoplot() function:\n# Usage:\n# hcoplot(tree = hclust.object,\n#   diss = dissimilarity.matrix,\n#   lab = object labels (default NULL),\n#   k = nb.clusters,\n#   title = paste(\"Reordered dendrogram from\",deparse(tree$call),\n#   sep=\"\\n\"))\nsource(\"stat5-8/hcoplot.R\")\nhcoplot(spe.ch.ward, spe.ch, lab = rownames(spe), k = 4)\n## Error in nrow(tree$merge): Objekt 'spe.ch.ward' nicht gefunden\n\n# Plot the Ward clusters on a map of the Doubs River\n# (see Chapter 2)\nsource(\"stat5-8/drawmap.R\")\ndrawmap(xy = spa, clusters = spech.ward.g, main = \"Four Ward clusters along the Doubs River\")\n## Error in plot(xy, asp = 1, type = \"n\", main = main, xlab = \"x coordinate (km)\", : Objekt 'spa' nicht gefunden\n```\n:::\n\n\n## Miscellaneous graphical outputs\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# konvertieren von \"hclust\" Objekt in ein Dendogram Objekt\ndend <- as.dendrogram(spe.ch.ward)\n## Error in as.dendrogram(spe.ch.ward): Objekt 'spe.ch.ward' nicht gefunden\n\n# Heat map of the dissimilarity matrix ordered with the dendrogram\nheatmap(as.matrix(spe.ch), Rowv = dend, symm = TRUE, margin = c(3, 3))\n## Error in as.matrix(spe.ch): Objekt 'spe.ch' nicht gefunden\n\n# Ordered community table\n# Species are ordered by their weighted averages on site scores.\n# Dots represent absences.\nlibrary(\"vegan\")\n## Error in library(\"vegan\"): es gibt kein Paket namens 'vegan'\nor <- vegemite(spe, spe.chwo)\n## Error in vegemite(spe, spe.chwo): konnte Funktion \"vegemite\" nicht finden\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}