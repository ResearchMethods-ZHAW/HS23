{
  "hash": "0f2bd69c5eabeadf78c4819276c49da9",
  "result": {
    "markdown": "---\nexecute:\n  echo: true   # set to true to show musterlösung\n  output: true # set to true to show musterlösung\ncode-fold: true\ncode-summary: \"Musterlösung\"\nknitr:\n  opts_chunk: \n    collapse: true\n---\n\n\n# 4. Einstieg Multivariate Modelle - Übung\n\nEinstieg Multivariate Modelle / Habitatselektionsmodell\n\n## Libraries laden\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nlibrary(\"sf\")\nlibrary(\"terra\")\nlibrary(\"dplyr\")\nlibrary(\"readr\")\nlibrary(\"ggplot2\")\nlibrary(\"PerformanceAnalytics\")\nlibrary(\"pastecs\")\nlibrary(\"car\")\nlibrary(\"psych\")\n## Error in library(\"psych\"): es gibt kein Paket namens 'psych'\n```\n:::\n\n\n## Aufgabe 1\n\nEinlesen des Gesamtdatensatzes für die Multivariate Analyse von Moodle\n\n1) Sichtung des Datensatzes, der Variablen und der Datentypen\n2) Kontrolle wieviele Rehe in diesem Datensatz enthalten sind\n\n\n::: {.cell}\n\n```{.r .cell-code}\nDF_mod <- read_delim(\"datasets/fallstudie_n/Aufgabe4_Datensatz_Habitatnutzung_Modelle_20221031_moodle.csv\", delim = \";\")\n\nstr(DF_mod)\n\nclass(DF_mod$time_of_day)\n\ntable(DF_mod$id)\n\nDF_mod |>\n  group_by(id) |>\n  summarize(anzahl = n())\n\nlength(unique(DF_mod$id))\n```\n:::\n\n\n## Aufgabe 2\n\nUnterteilung des Datensatzes in Teildatensätze entsprechend der Tageszeit \n\n\n::: {.cell}\n\n```{.r .cell-code}\nDF_mod_night <- DF_mod |>\n  filter(time_of_day == \"night\")\n\nDF_mod_day <- DF_mod |>\n  filter(time_of_day == \"day\")\n\n# Kontrolle\ntable(DF_mod_night$time_of_day)\n## \n## night \n##  4185\n\ntable(DF_mod_day$time_of_day)\n## \n##  day \n## 4185\n```\n:::\n\n\n## Aufgabe 3\n\nErstellen von Density Plots der Präsenz / Absenz in Abhängigkeit der unabhängigen Variablen. Diese Übung dient einer ersten groben Einschätzung der Wirkung der Umweltvariablen auf die abhängige Variable (Präsenz/Absenz in unserem Fall)\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\n# Ein Satz Density Plots für den Tagesdatensatz und einer für den Nachtdatensatz\n\npar(mfrow = c(3, 3), mar = c(4, 4, 3, 3)) # Vorbereitung Raster für Plots\n\n# innerhalb des for()-loops die Nummern der gewünschten Spalten einstellen\n\nfor (i in 6:12) {\n  dp <- DF_mod_day |> filter(pres_abs == 1) |> pull(i)\n  dp <- density(dp)\n  da <- DF_mod_day |> filter(pres_abs == 0) |> pull(i)\n  da <- density(da)\n  plot(0, 0, type = \"l\",\n    xlim = range(c(dp$x, da$x)),\n    ylim = range(dp$y, da$y),\n    xlab = names(DF_mod_day[i]),\n    ylab = \"Density\"\n  )\n  lines(dp$x, dp$y, col = \"blue\")             # Präsenz\n  lines(da$x, da$y, col = \"red\")              # Absenz\n}\n```\n\n::: {.cell-output-display}\n![](4_Multivariate_Modelle_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n## Aufgabe 4\n\nTesten eurer erklärenden Variablen auf Normalverteilung (nur kontinuierliche) \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# klassischer Weg mit shapiro-wilk (mehrere Spalten, verschiedenene statistische\n# Kenngrössen werden angezeigt. Normalverteilung: Wert ganz unten. p>0.05 = ja)\n\nround(stat.desc(DF_mod_day[6:12], basic = F, norm = T), 3)\n##                slope dist_road_all dist_road_only dist_build forest_prop     us\n## median        13.442        28.248         33.693    129.838       0.632  0.059\n## mean          15.055        41.289         46.374    154.502       0.590  0.120\n## SE.mean        0.158         0.642          0.665      1.625       0.005  0.002\n## CI.mean.0.95   0.311         1.259          1.303      3.186       0.010  0.005\n## var          104.994      1725.368       1848.647  11050.895       0.107  0.023\n## std.dev       10.247        41.538         42.996    105.123       0.328  0.151\n## coef.var       0.681         1.006          0.927      0.680       0.555  1.259\n## skewness       0.753         1.914          1.666      0.631      -0.366  1.674\n## skew.2SE       9.945        25.285         22.003      8.341      -4.832 22.115\n## kurtosis      -0.042         4.250          3.147     -0.537      -1.094  3.061\n## kurt.2SE      -0.279        28.079         20.790     -3.545      -7.226 20.226\n## normtest.W     0.942         0.800          0.837      0.943       0.919  0.792\n## normtest.p     0.000         0.000          0.000      0.000       0.000  0.000\n##                   os\n## median         0.754\n## mean           0.586\n## SE.mean        0.006\n## CI.mean.0.95   0.013\n## var            0.173\n## std.dev        0.416\n## coef.var       0.710\n## skewness      -0.388\n## skew.2SE      -5.124\n## kurtosis      -1.586\n## kurt.2SE     -10.481\n## normtest.W     0.791\n## normtest.p     0.000\n\n# empfohlener Weg\n\nggplot(DF_mod_day, aes(slope)) +\n  geom_histogram(aes(y = ..density..), color = \"black\", fill = \"white\") +\n  stat_function(fun = dnorm, args = list(mean = mean(DF_mod_day$slope, na.rm = T), sd = sd(DF_mod_day$slope, na.rm = T)), color = \"black\", size = 1)\n```\n\n::: {.cell-output-display}\n![](4_Multivariate_Modelle_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Aufgabe 4: die Verteilung bei einem Teildatensatz zu testen reicht,\n# denn die verwendeten Kreise sind die selben am Tag und in der Nacht,\n# nur die Nutzung durch das Reh nicht\n```\n:::\n\n\n## Aufgabe 5\n\nExplorative Analysen der Variablen mit Scatterplots / Scatterplotmatrizen \n\n1) Zu Scatterplots und Scatterplotmatrizen gibt es viele verschiedene Funktionen / Packages, schaut im Internet und sucht euch eines welches euch passt.\n2) Testen der Korrelation zwischen den Variablen (Parametrisch oder nicht-parametrische Methode? Ausserdem: gewisse Scatterplotmatrizen zeigen euch die Koeffizenten direkt an)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchart.Correlation(DF_mod_day[6:12], histogram = TRUE, pch = 19, method = \"kendall\")\n```\n\n::: {.cell-output-display}\n![](4_Multivariate_Modelle_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n\n```{.r .cell-code}\n\n# ?chart.Correlation\n\npairs.panels(DF_mod_day[6:12],\n  method = \"kendall\", # correlation method\n  hist.col = \"#00AFBB\",\n  density = TRUE, # show density plots\n  ellipses = TRUE # show correlation ellipses\n)\n## Error in pairs.panels(DF_mod_day[6:12], method = \"kendall\", hist.col = \"#00AFBB\", : konnte Funktion \"pairs.panels\" nicht finden\n\n# Aufgabe 5: die Korrelation bei einem Teildatensatz zu testen reicht,\n# denn die verwendeten Kreise sind die selben am Tag und in der Nacht,\n# nur die Nutzung durch das Reh nicht.\n```\n:::\n",
    "supporting": [
      "4_Multivariate_Modelle_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}