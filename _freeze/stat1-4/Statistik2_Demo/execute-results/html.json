{
  "hash": "9302265446b079798734192ff249a414",
  "result": {
    "markdown": "---\ndate: 2023-10-31\nlesson: Stat2\nthema: Einführung in lineare Modelle\nindex: 1\nformat:\n  html:\n    code-tools:\n      source: true\n---\n\n\n# Stat2: Demo\n\n- Download dieses Demoscript via \"\\</\\>Code\" (oben rechts)\n- Datensatz *Nitrogen.csv*\n- Datensatz *Riesch_et_al_ReMe_Extract.csv*\n\n## t-test als ANOVA\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Daten generieren als \"long table\" (2 Kategorien)\na <- c(20, 19, 25, 10, 8, 15, 13, 18, 11, 14)\nb <- c(12, 15, 16, 7, 8, 10, 12, 11, 13, 10)\nblume <- data.frame(cultivar = c(rep(\"a\", 10), rep(\"b\", 10)), size = c(a, b))\n\n# Daten anschauen\npar(mfrow = c(1, 1))\nboxplot(size ~ cultivar, xlab = \"Sorte\", ylab = \"Bluetengroesse [cm]\", data = blume)\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\n\n# Klassischer t-Test ausführen\nt.test(size ~ cultivar, blume, var.equal = TRUE)\n## \n## \tTwo Sample t-test\n## \n## data:  size by cultivar\n## t = 2.0797, df = 18, p-value = 0.05212\n## alternative hypothesis: true difference in means between group a and group b is not equal to 0\n## 95 percent confidence interval:\n##  -0.03981237  7.83981237\n## sample estimates:\n## mean in group a mean in group b \n##            15.3            11.4\n\n# ANOVA ausführen\naov(size ~ cultivar, data = blume)\n## Call:\n##    aov(formula = size ~ cultivar, data = blume)\n## \n## Terms:\n##                 cultivar Residuals\n## Sum of Squares     76.05    316.50\n## Deg. of Freedom        1        18\n## \n## Residual standard error: 4.193249\n## Estimated effects may be unbalanced\nsummary(aov(size ~ cultivar, data = blume))\n##             Df Sum Sq Mean Sq F value Pr(>F)  \n## cultivar     1   76.0   76.05   4.325 0.0521 .\n## Residuals   18  316.5   17.58                 \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\nsummary.lm(aov(size ~ cultivar, data = blume))\n## \n## Call:\n## aov(formula = size ~ cultivar, data = blume)\n## \n## Residuals:\n##    Min     1Q Median     3Q    Max \n## -7.300 -2.575 -0.350  2.925  9.700 \n## \n## Coefficients:\n##             Estimate Std. Error t value Pr(>|t|)    \n## (Intercept)   15.300      1.326   11.54 9.47e-10 ***\n## cultivarb     -3.900      1.875   -2.08   0.0521 .  \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Residual standard error: 4.193 on 18 degrees of freedom\n## Multiple R-squared:  0.1937,\tAdjusted R-squared:  0.1489 \n## F-statistic: 4.325 on 1 and 18 DF,  p-value: 0.05212\n```\n:::\n\n\n## Echte ANOVA\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Daten generieren mit 3 statt nur 2 Kategorien\nc <- c(30, 19, 31, 23, 18, 25, 26, 24, 17, 20)\nblume2 <- data.frame(cultivar = c(rep(\"a\", 10), rep(\"b\", 10), rep(\"c\", 10)), size = c(a, b, c))\nblume2$cultivar <- as.factor(blume2$cultivar)\n\nsummary(blume2)\n##  cultivar      size      \n##  a:10     Min.   : 7.00  \n##  b:10     1st Qu.:11.25  \n##  c:10     Median :15.50  \n##           Mean   :16.67  \n##           3rd Qu.:20.00  \n##           Max.   :31.00\nhead(blume2)\n##   cultivar size\n## 1        a   20\n## 2        a   19\n## 3        a   25\n## 4        a   10\n## 5        a    8\n## 6        a   15\n\npar(mfrow = c(1, 1))\nboxplot(size ~ cultivar, xlab = \"Sorte\", ylab = \"Blütengrösse [cm]\", data = blume2)\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\n\naov(size ~ cultivar, data = blume2)\n## Call:\n##    aov(formula = size ~ cultivar, data = blume2)\n## \n## Terms:\n##                 cultivar Residuals\n## Sum of Squares  736.0667  528.6000\n## Deg. of Freedom        2        27\n## \n## Residual standard error: 4.424678\n## Estimated effects may be unbalanced\nsummary(aov(size ~ cultivar, data = blume2))\n##             Df Sum Sq Mean Sq F value   Pr(>F)    \n## cultivar     2  736.1   368.0    18.8 7.68e-06 ***\n## Residuals   27  528.6    19.6                     \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\nsummary.lm(aov(size ~ cultivar, data = blume2))\n## \n## Call:\n## aov(formula = size ~ cultivar, data = blume2)\n## \n## Residuals:\n##    Min     1Q Median     3Q    Max \n## -7.300 -3.375 -0.300  2.700  9.700 \n## \n## Coefficients:\n##             Estimate Std. Error t value Pr(>|t|)    \n## (Intercept)   15.300      1.399  10.935 2.02e-11 ***\n## cultivarb     -3.900      1.979  -1.971 0.059065 .  \n## cultivarc      8.000      1.979   4.043 0.000395 ***\n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Residual standard error: 4.425 on 27 degrees of freedom\n## Multiple R-squared:  0.582,\tAdjusted R-squared:  0.5511 \n## F-statistic:  18.8 on 2 and 27 DF,  p-value: 7.683e-06\n\naov.1 <- aov(size ~ cultivar, data = blume2)\nsummary(aov.1)\n##             Df Sum Sq Mean Sq F value   Pr(>F)    \n## cultivar     2  736.1   368.0    18.8 7.68e-06 ***\n## Residuals   27  528.6    19.6                     \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\nsummary.lm(aov.1)\n## \n## Call:\n## aov(formula = size ~ cultivar, data = blume2)\n## \n## Residuals:\n##    Min     1Q Median     3Q    Max \n## -7.300 -3.375 -0.300  2.700  9.700 \n## \n## Coefficients:\n##             Estimate Std. Error t value Pr(>|t|)    \n## (Intercept)   15.300      1.399  10.935 2.02e-11 ***\n## cultivarb     -3.900      1.979  -1.971 0.059065 .  \n## cultivarc      8.000      1.979   4.043 0.000395 ***\n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Residual standard error: 4.425 on 27 degrees of freedom\n## Multiple R-squared:  0.582,\tAdjusted R-squared:  0.5511 \n## F-statistic:  18.8 on 2 and 27 DF,  p-value: 7.683e-06\n\n# Berechnung Mittelwerte usw. zur Charakterisierung der Gruppen\naggregate(size ~ cultivar, blume2, function(x) c(Mean = mean(x), SD = sd(x), Min = min(x), Max = max(x)))\n##   cultivar size.Mean   size.SD  size.Min  size.Max\n## 1        a 15.300000  5.207900  8.000000 25.000000\n## 2        b 11.400000  2.836273  7.000000 16.000000\n## 3        c 23.300000  4.854551 17.000000 31.000000\n\nlm.1 <- lm(size ~ cultivar, data = blume2)\nsummary(lm.1)\n## \n## Call:\n## lm(formula = size ~ cultivar, data = blume2)\n## \n## Residuals:\n##    Min     1Q Median     3Q    Max \n## -7.300 -3.375 -0.300  2.700  9.700 \n## \n## Coefficients:\n##             Estimate Std. Error t value Pr(>|t|)    \n## (Intercept)   15.300      1.399  10.935 2.02e-11 ***\n## cultivarb     -3.900      1.979  -1.971 0.059065 .  \n## cultivarc      8.000      1.979   4.043 0.000395 ***\n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Residual standard error: 4.425 on 27 degrees of freedom\n## Multiple R-squared:  0.582,\tAdjusted R-squared:  0.5511 \n## F-statistic:  18.8 on 2 and 27 DF,  p-value: 7.683e-06\n```\n:::\n\n\n## Tukeys Posthoc-Test\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load library\nlibrary(\"agricolae\")\n## Error in library(\"agricolae\"): there is no package called 'agricolae'\n\n# Posthoc-Test\nHSD.test(aov.1, \"cultivar\", group = FALSE, console = TRUE)\n## Error in HSD.test(aov.1, \"cultivar\", group = FALSE, console = TRUE): could not find function \"HSD.test\"\n```\n:::\n\n\n## Beispiel Posthoc-Labels in Plot\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# ANOVA Mit Iris-Datenset, das in R integriert ist\naov.2 <- aov(Sepal.Width ~ Species, data = iris)\n\n# Posthoc-Test\nHSD.test(aov.2, \"Species\", console = TRUE)\n## Error in HSD.test(aov.2, \"Species\", console = TRUE): could not find function \"HSD.test\"\n\n# Plot mit labels\nboxplot(Sepal.Width ~ Species, data = iris)\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\nboxplot(Sepal.Width ~ Species, ylim = c(2, 5), data = iris)\ntext(1, 4.8, \"a\")\ntext(2, 4.8, \"c\")\ntext(3, 4.8, \"b\")\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-4-2.png){width=672}\n:::\n:::\n\n\nDerselbe Plot mit ggplot\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load library\nlibrary(\"ggplot2\")\n\nggplot(iris, aes(Species, Sepal.Width)) +\n    geom_boxplot(size = 1) +\n    annotate(\"text\", y = 5, x = 1:3, label = c(\"a\", \"c\", \"b\"))\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n## Klassische Tests der Modellannahmen (NICHT EMPFOHLEN!!!)\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Shapiro-Wilk Test auf Normalverteilung\n# Pro Kategorie!\n# (H0 = Notmalverteilung)\nshapiro.test(blume2$size[blume2$cultivar == \"a\"])\n## \n## \tShapiro-Wilk normality test\n## \n## data:  blume2$size[blume2$cultivar == \"a\"]\n## W = 0.97304, p-value = 0.9175\nshapiro.test(blume2$size[blume2$cultivar == \"b\"])\n## \n## \tShapiro-Wilk normality test\n## \n## data:  blume2$size[blume2$cultivar == \"b\"]\n## W = 0.97341, p-value = 0.9206\nshapiro.test(blume2$size[blume2$cultivar == \"c\"])\n## \n## \tShapiro-Wilk normality test\n## \n## data:  blume2$size[blume2$cultivar == \"c\"]\n## W = 0.94188, p-value = 0.5742\n?var.test\n\n# F-Test zum Vergleich zweier Varianzen\n# (H0= Gleiche Varianzen)\nvar.test(\n    blume2$size[blume2$cultivar == \"a\"],\n    blume2$size[blume2$cultivar == \"b\"]\n)\n## \n## \tF test to compare two variances\n## \n## data:  blume2$size[blume2$cultivar == \"a\"] and blume2$size[blume2$cultivar == \"b\"]\n## F = 3.3715, num df = 9, denom df = 9, p-value = 0.08467\n## alternative hypothesis: true ratio of variances is not equal to 1\n## 95 percent confidence interval:\n##   0.8374446 13.5738284\n## sample estimates:\n## ratio of variances \n##           3.371547\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load library\nlibrary(\"car\")\n\n# Test auf Homogenität der Varianzen\nleveneTest(blume2$size[blume2$cultivar == \"a\"],\n    blume2$size[blume2$cultivar == \"b\"],\n    center = mean\n)\n## Levene's Test for Homogeneity of Variance (center = mean)\n##       Df    F value    Pr(>F)    \n## group  7 2.2598e+30 < 2.2e-16 ***\n##        2                         \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n\n## Nicht-parametrische Alternativen, wenn Modellannahmen der ANVOA massiv verletzt sind\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Nicht-parametrische Alternative zu t-Test\nwilcox.test(\n    blume2$size[blume2$cultivar == \"a\"],\n    blume2$size[blume2$cultivar == \"b\"]\n)\n## \n## \tWilcoxon rank sum test with continuity correction\n## \n## data:  blume2$size[blume2$cultivar == \"a\"] and blume2$size[blume2$cultivar == \"b\"]\n## W = 73, p-value = 0.08789\n## alternative hypothesis: true location shift is not equal to 0\n```\n:::\n\n\n## Zum Vergleich normale ANOVA noch mal\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(aov(size ~ cultivar, data = blume2))\n##             Df Sum Sq Mean Sq F value   Pr(>F)    \n## cultivar     2  736.1   368.0    18.8 7.68e-06 ***\n## Residuals   27  528.6    19.6                     \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n\n## Bei starken Abweichungen von der Normalverteilung, aber ähnlichen Varianzen\n\n## Kruskal-Wallis-Test\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkruskal.test(size ~ cultivar, data = blume2)\n## \n## \tKruskal-Wallis rank sum test\n## \n## data:  size by cultivar\n## Kruskal-Wallis chi-squared = 16.686, df = 2, p-value = 0.0002381\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load library\nlibrary(\"FSA\")\n## Error in library(\"FSA\"): there is no package called 'FSA'\n\n# korrigierte p-Werte nach Bejamini-Hochberg\ndunnTest(size ~ cultivar, method = \"bh\", data = blume2)\n## Error in dunnTest(size ~ cultivar, method = \"bh\", data = blume2): could not find function \"dunnTest\"\n```\n:::\n\n\n## Bei erheblicher Heteroskedastizität, aber relative normal/symmetrisch verteilten Residuen\n\n## Welch-Test\n\n\n::: {.cell}\n\n```{.r .cell-code}\noneway.test(size ~ cultivar, var.equal = F, data = blume2)\n## \n## \tOne-way analysis of means (not assuming equal variances)\n## \n## data:  size and cultivar\n## F = 21.642, num df = 2.000, denom df = 16.564, p-value = 2.397e-05\n```\n:::\n\n\n## 2-faktorielle ANOVA\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Daten generieren\nd <- c(10, 12, 11, 13, 10, 25, 12, 30, 26, 13)\ne <- c(15, 13, 18, 11, 14, 25, 39, 38, 28, 24)\nf <- c(10, 12, 11, 13, 10, 9, 2, 4, 7, 13)\n\nblume3 <- data.frame(\n    cultivar = c(rep(\"a\", 20), rep(\"b\", 20), rep(\"c\", 20)),\n    house = c(rep(c(rep(\"yes\", 10), rep(\"no\", 10)), 3)),\n    size = c(a, b, c, d, e, f)\n)\nblume3\n##    cultivar house size\n## 1         a   yes   20\n## 2         a   yes   19\n## 3         a   yes   25\n## 4         a   yes   10\n## 5         a   yes    8\n## 6         a   yes   15\n## 7         a   yes   13\n## 8         a   yes   18\n## 9         a   yes   11\n## 10        a   yes   14\n## 11        a    no   12\n## 12        a    no   15\n## 13        a    no   16\n## 14        a    no    7\n## 15        a    no    8\n## 16        a    no   10\n## 17        a    no   12\n## 18        a    no   11\n## 19        a    no   13\n## 20        a    no   10\n## 21        b   yes   30\n## 22        b   yes   19\n## 23        b   yes   31\n## 24        b   yes   23\n## 25        b   yes   18\n## 26        b   yes   25\n## 27        b   yes   26\n## 28        b   yes   24\n## 29        b   yes   17\n## 30        b   yes   20\n## 31        b    no   10\n## 32        b    no   12\n## 33        b    no   11\n## 34        b    no   13\n## 35        b    no   10\n## 36        b    no   25\n## 37        b    no   12\n## 38        b    no   30\n## 39        b    no   26\n## 40        b    no   13\n## 41        c   yes   15\n## 42        c   yes   13\n## 43        c   yes   18\n## 44        c   yes   11\n## 45        c   yes   14\n## 46        c   yes   25\n## 47        c   yes   39\n## 48        c   yes   38\n## 49        c   yes   28\n## 50        c   yes   24\n## 51        c    no   10\n## 52        c    no   12\n## 53        c    no   11\n## 54        c    no   13\n## 55        c    no   10\n## 56        c    no    9\n## 57        c    no    2\n## 58        c    no    4\n## 59        c    no    7\n## 60        c    no   13\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nboxplot(size ~ cultivar + house, data = blume3)\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n\n```{.r .cell-code}\n\nsummary(aov(size ~ cultivar + house, data = blume3))\n##             Df Sum Sq Mean Sq F value   Pr(>F)    \n## cultivar     2  417.1   208.5   5.005     0.01 *  \n## house        1  992.3   992.3  23.815 9.19e-06 ***\n## Residuals   56 2333.2    41.7                     \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\nsummary(aov(size ~ cultivar + house + cultivar:house, data = blume3))\n##                Df Sum Sq Mean Sq F value   Pr(>F)    \n## cultivar        2  417.1   208.5   5.364   0.0075 ** \n## house           1  992.3   992.3  25.520 5.33e-06 ***\n## cultivar:house  2  233.6   116.8   3.004   0.0579 .  \n## Residuals      54 2099.6    38.9                     \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n# Kurzschreibweise: \"*\" bedeutet, dass Interaktion zwischen cultivar und house eingeschlossen wird\nsummary(aov(size ~ cultivar * house, data = blume3))\n##                Df Sum Sq Mean Sq F value   Pr(>F)    \n## cultivar        2  417.1   208.5   5.364   0.0075 ** \n## house           1  992.3   992.3  25.520 5.33e-06 ***\n## cultivar:house  2  233.6   116.8   3.004   0.0579 .  \n## Residuals      54 2099.6    38.9                     \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nsummary.lm(aov(size ~ cultivar + house, data = blume3))\n## \n## Call:\n## aov(formula = size ~ cultivar + house, data = blume3)\n## \n## Residuals:\n##    Min     1Q Median     3Q    Max \n## -9.733 -4.696 -1.050  2.717 19.133 \n## \n## Coefficients:\n##             Estimate Std. Error t value Pr(>|t|)    \n## (Intercept)    9.283      1.667   5.570 7.52e-07 ***\n## cultivarb      6.400      2.041   3.135  0.00273 ** \n## cultivarc      2.450      2.041   1.200  0.23509    \n## houseyes       8.133      1.667   4.880 9.19e-06 ***\n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Residual standard error: 6.455 on 56 degrees of freedom\n## Multiple R-squared:  0.3766,\tAdjusted R-squared:  0.3432 \n## F-statistic: 11.28 on 3 and 56 DF,  p-value: 6.848e-06\n\ninteraction.plot(blume3$cultivar, blume3$house, blume3$size)\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-14-2.png){width=672}\n:::\n\n```{.r .cell-code}\ninteraction.plot(blume3$house, blume3$cultivar, blume3$size)\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-14-3.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nanova(lm(blume3$size ~ blume3$cultivar * blume3$house), lm(blume3$size ~ blume3$cultivar + blume3$house))\n## Analysis of Variance Table\n## \n## Model 1: blume3$size ~ blume3$cultivar * blume3$house\n## Model 2: blume3$size ~ blume3$cultivar + blume3$house\n##   Res.Df    RSS Df Sum of Sq      F  Pr(>F)  \n## 1     54 2099.6                              \n## 2     56 2333.2 -2   -233.63 3.0044 0.05792 .\n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\nanova(lm(blume3$size ~ blume3$house), lm(blume3$size ~ blume3$cultivar * blume3$house))\n## Analysis of Variance Table\n## \n## Model 1: blume3$size ~ blume3$house\n## Model 2: blume3$size ~ blume3$cultivar * blume3$house\n##   Res.Df    RSS Df Sum of Sq      F   Pr(>F)   \n## 1     58 2750.3                                \n## 2     54 2099.6  4    650.73 4.1841 0.005045 **\n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n# Visualisierung 2-fach-Interaktion etwas elaborierter mit ggplot\nlibrary(\"sjPlot\")\nlibrary(\"ggplot2\")\ntheme_set(theme_classic())\n\naov <- aov(size ~ cultivar * house, data = blume3)\nplot_model(aov, type = \"pred\", terms = c(\"cultivar\", \"house\"))\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Geht auch für 3-fach-Interaktionen\n\n# Datensatz zum Einfluss von Management und Hirschbeweidung auf den Pflanzenartenreichtum\n\nRiesch <- read.delim(\"datasets/stat1-4/Riesch_et_al_ReMe_Extract.csv\", sep = \";\", stringsAsFactors = TRUE)\nstr(Riesch)\n## 'data.frame':\t60 obs. of  5 variables:\n##  $ Plot.ID         : Factor w/ 60 levels \"Eul_A1_MP_14\",..: 9 17 33 37 49 10 18 34 38 50 ...\n##  $ Year            : Factor w/ 2 levels \"Year 1\",\"Year 4\": 1 1 1 1 1 2 2 2 2 2 ...\n##  $ Treatment       : Factor w/ 3 levels \"burnt\",\"mown\",..: 1 1 1 1 1 1 1 1 1 1 ...\n##  $ Plot.type       : Factor w/ 2 levels \"fenced\",\"open\": 1 1 1 1 1 1 1 1 1 1 ...\n##  $ Species.richness: int  45 49 44 52 43 37 42 36 46 38 ...\n\naov.deer <- aov(Species.richness ~ Year * Treatment * Plot.type, data = Riesch)\nplot_model(aov.deer, type = \"pred\", terms = c(\"Year\", \"Treatment\", \"Plot.type\"))\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n## Korrelationen\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Korrelationen und Regressionen\n\n# Datensatz zum Einfluss von Stickstoffdepositionen auf den Pflanzenartenreichtum\ndf <- read.delim(\"datasets/stat1-4/Nitrogen.csv\", sep = \";\")\nsummary(df)\n##   N.deposition   Species.richness\n##  Min.   : 2.00   Min.   :12.0    \n##  1st Qu.: 9.00   1st Qu.:17.5    \n##  Median :20.00   Median :21.0    \n##  Mean   :20.53   Mean   :20.2    \n##  3rd Qu.:30.50   3rd Qu.:23.0    \n##  Max.   :55.00   Max.   :28.0\n\n# Plotten der Beziehung\nplot(Species.richness ~ N.deposition, data = df)\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n\n```{.r .cell-code}\n\n# Daten anschauen\nscatterplot(Species.richness ~ N.deposition, data = df)\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-17-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Korrelationen\ncor.test(df$Species.richness, df$N.deposition, method = \"pearson\")\n## \n## \tPearson's product-moment correlation\n## \n## data:  df$Species.richness and df$N.deposition\n## t = -5.2941, df = 13, p-value = 0.0001453\n## alternative hypothesis: true correlation is not equal to 0\n## 95 percent confidence interval:\n##  -0.9405572 -0.5450218\n## sample estimates:\n##        cor \n## -0.8265238\ncor.test(df$N.deposition, df$Species.richness, method = \"pearson\")\n## \n## \tPearson's product-moment correlation\n## \n## data:  df$N.deposition and df$Species.richness\n## t = -5.2941, df = 13, p-value = 0.0001453\n## alternative hypothesis: true correlation is not equal to 0\n## 95 percent confidence interval:\n##  -0.9405572 -0.5450218\n## sample estimates:\n##        cor \n## -0.8265238\ncor.test(df$Species.richness, df$N.deposition, method = \"spearman\")\n## \n## \tSpearman's rank correlation rho\n## \n## data:  df$Species.richness and df$N.deposition\n## S = 1015.5, p-value = 0.0002259\n## alternative hypothesis: true rho is not equal to 0\n## sample estimates:\n##        rho \n## -0.8133721\ncor.test(df$Species.richness, df$N.deposition, method = \"kendall\")\n## \n## \tKendall's rank correlation tau\n## \n## data:  df$Species.richness and df$N.deposition\n## z = -3.308, p-value = 0.0009398\n## alternative hypothesis: true tau is not equal to 0\n## sample estimates:\n##       tau \n## -0.657115\n\n# Jetzt als Regression\nlm <- lm(Species.richness ~ N.deposition, data = df)\nanova(lm) # ANOVA-Tabelle, 1. Möglichkeit\n## Analysis of Variance Table\n## \n## Response: Species.richness\n##              Df Sum Sq Mean Sq F value    Pr(>F)    \n## N.deposition  1 233.91 233.908  28.028 0.0001453 ***\n## Residuals    13 108.49   8.346                      \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\nsummary.aov(lm) # ANOVA-Tabelle, 2. Möglichkeit\n##              Df Sum Sq Mean Sq F value   Pr(>F)    \n## N.deposition  1  233.9  233.91   28.03 0.000145 ***\n## Residuals    13  108.5    8.35                     \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\nsummary(lm) # Regressionskoeffizienten\n## \n## Call:\n## lm(formula = Species.richness ~ N.deposition, data = df)\n## \n## Residuals:\n##     Min      1Q  Median      3Q     Max \n## -4.9184 -1.9992  0.4493  2.0015  4.6081 \n## \n## Coefficients:\n##              Estimate Std. Error t value Pr(>|t|)    \n## (Intercept)  25.60502    1.26440  20.251 3.25e-11 ***\n## N.deposition -0.26323    0.04972  -5.294 0.000145 ***\n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Residual standard error: 2.889 on 13 degrees of freedom\n## Multiple R-squared:  0.6831,\tAdjusted R-squared:  0.6588 \n## F-statistic: 28.03 on 1 and 13 DF,  p-value: 0.0001453\n\n# Signifikantes Ergebnis visualisieren\nplot(Species.richness ~ N.deposition, data = df)\nabline(lm)\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\n## Beispiele Modelldiagnostik\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(2, 2)) # 4 Plots in einem Fenster\nplot(lm(b ~ a))\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load library\nlibrary(\"ggfortify\")\n\nautoplot(lm(b ~ a))\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n\n```{.r .cell-code}\n\n# Modellstatistik nicht OK\ng <- c(20, 19, 25, 10, 8, 15, 13, 18, 11, 14, 25, 39, 38, 28, 24)\nh <- c(12, 15, 10, 7, 8, 10, 12, 11, 13, 10, 25, 12, 30, 26, 13)\npar(mfrow = c(1, 1))\n\nplot(h ~ g, xlim = c(0, 40), ylim = c(0, 30))\nabline(lm(h ~ g))\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-20-2.png){width=672}\n:::\n\n```{.r .cell-code}\n\npar(mfrow = c(2, 2))\nplot(lm(h ~ g))\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-20-3.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Modelldiagnostik mit ggplot\ndf <- data.frame(g, h)\nggplot(df, aes(x = g, y = h)) +\n    # scale_x_continuous(limits = c(0,25)) +\n    # scale_y_continuous(limits = c(0,25)) +\n    geom_point() +\n    geom_smooth(method = \"lm\", color = \"black\", size = .5, se = F) +\n    theme_classic()\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n\n```{.r .cell-code}\n\npar(mfrow = c(2, 2))\nautoplot(lm(h ~ g))\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-21-2.png){width=672}\n:::\n:::\n",
    "supporting": [
      "Statistik2_Demo_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}